{% extends 'base.html' %}
<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport" maximum-scale=1.0, user-scalable=0”>
    <title></title>
    <link rel="icon" type="image/ico" href="/static/favicon.ico">
    <link rel="shortcut icon" type="image/ico" href="/static/favicon.ico">
    <!-- sunnylogin -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/css/bootstrap-multiselect.min.css"
        rel="stylesheet">
    <link href="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/jquery-peeper.css">
    <link rel="stylesheet" href="/static/css/index.css">

    <script type="text/javascript" src="http://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/js/bootstrap-multiselect.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-submenu/3.0.1/js/bootstrap-submenu.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.js"></script>
    <script src="/static/js/index.js"></script>
    <script src="/static/js/jquery-peeper.js"></script>
    <script>
        $(function () {
            $("#password1").peeper({
                mask: false,
                showPasswordCss: 'fa fa-eye',
                showCopyBtn: false
            });
        });
    </script>
    <style>
        @keyframes spinning {
            0% { transform: rotateZ(0deg);}
            90% { transform: rotateZ(720deg);}
            100% { transform: rotateZ(720deg);}
        }
        
        .loadingData{
            width: 50px;
            height: 50px;
            margin: auto;
            position: relative;
        }

        .loadingData > span{
            display: block;
            position: absolute;
            width: 36px;
            height: 36px;
            border-width: 5px;
            border-radius: 50%;
            border-style: solid;
            border-color: #007bff transparent transparent transparent;
        }

        .loadingData > span:nth-child(1){
            animation: spinning 3s ease-in-out 0s infinite;
        }
        .loadingData > span:nth-child(2){
            animation: spinning 3s ease-in-out 0.15s infinite;
        }
        .loadingData > span:nth-child(3){
            animation: spinning 3s ease-in-out 0.3s infinite;
        }
        .loadingData > span:nth-child(4){
            animation: spinning 3s ease-in-out 0.45s infinite;
        }
    </style>
    {% endblock %}
</head>

<body>
    {% block body %}
    <div id="vue_app" class="cont">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand logo1" href="#"></a>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item bi"><a href="#">土地開發</a></li>
                    </ol>
                </nav>
            </div>
            <div class="d-flex">
                <a href="#" type="button" class="btn dropdown-toggle w-150" data-toggle="dropdown" aria-expanded="false">
                    {% if user.first_name == '' %}
                    {{ user.username }}
                    {% else %}
                    {{ user.first_name }}
                    {% endif %}
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"></path></svg>
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                        <a href="#" id="buttonForLogout" class="btn dropdown-item" @click="logout()">
                            <img src="/static/images/返回.png" style="width: 24px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;登出
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="container wrap">
            <nav aria-label="breadcrumb" class="bb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">首頁</a></li>
                    <li class="breadcrumb-item" :class="{active: !showResult}" :style="showResult ? 'cursor: pointer': ''" @click="showResult=0">土地開發</li>
                    <li class="breadcrumb-item active" v-if="showResult">搜尋結果</li>
                </ol>
            </nav>
            <div class="row r1">
                <div class="row">
                    <label class="col-form-label w-80 text-center1" for="edit-text-name-id">搜尋</label>
                    <div class="col w-200">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.city" @change="getArea(searchForm.land.region.city)">
                            <option :value="null" selected>縣市</option>
                            <option :value="key" v-for="(value, key) in cityList"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col w-200">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.area" @change="getSection(searchForm.land.region.area), getPlan(searchForm.land.region.area)">
                            <option :value="null" selected>行政區</option>
                            <option :value="key" v-for="(value, key) in areaList[searchForm.land.region.city]"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col w-200">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.section" @change="searchForm.land.region.plan=null">
                            <option :value="null" selected>段小段</option>
                            <option :value="key" v-for="(value, key) in sectionList[searchForm.land.region.area]"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col w-200">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.plan" @change="searchForm.land.region.section=null">
                            <option :value="null" selected>計劃案</option>
                            <option :value="key" v-for="(value, key) in planList[searchForm.land.region.area]"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col w-200">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle  custom-select left" type="button"
                                id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                地號
                            </button>
                            <div class="dropdown-menu">
                                <form class="px-4 py-3 row pp">
                                    <div class="form-check col-sm-12 pp2">
                                        <input class="form-control" :class="{'is-invalid': !landbuildNumberFix(searchForm.land.region.land_number, 'l').ok}" placeholder="地號" v-model="searchForm.land.region.land_number">
                                    </div>
                                    <div class="form-group col-sm-6">
                                    </div>
                                    <div class="form-group col-sm-6 pp1 d-none">
                                        <input type="checkbox" class="form-check-input" id="dropdownCheck" v-model="searchForm.land.region.includeInvalid">
                                        <label class="form-check-label" for="dropdownCheck">包含失效資料</label>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="col w-200">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle custom-select on on1 left" type="button"
                                data-toggle="dropdown" data-submenu>
                                使用分區
                            </button>
                            <div class="dropdown-menu">
                                <div class="dropdown dropright">
                                    <button class="dropdown-item" type="button" @click.stop="clearInOutCitty()">不拘</button>
                                </div>
                                <div class="dropdown dropright dropdown-submenu">
                                    <button class="dropdown-item dropdown-toggle" type="button">都內</button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item" type="button" v-for="(i, idx) in inCity" @click.stop>
                                            <input type="checkbox" class="form-check-input" :id="'inCity' + idx" v-model="searchForm.land.condition.inCity[i]">
                                            <label class="m-0 w-100" :for="'inCity' + idx">(( i ))</label>
                                        </button>
                                    </div>
                                </div>
                                <div class="dropdown dropright dropdown-submenu">
                                    <button class="dropdown-item dropdown-toggle" type="button">都外</button>
                                    <div class="dropdown-menu">
                                        <div class="dropdown dropright dropdown-submenu">
                                            <button class="dropdown-item dropdown-toggle" type="button">使用分區</button>
                                            <div class="dropdown-menu">
                                                <button class="dropdown-item" type="button" v-for="(i, idx) in outCity" @click.stop>
                                                    <input type="checkbox" class="form-check-input" :id="'outCity' + idx" v-model="searchForm.land.condition.outCity[i]">
                                                    <label class="m-0 w-100" :for="'outCity' + idx">(( i ))</label>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="dropdown dropright dropdown-submenu">
                                            <button class="dropdown-item dropdown-toggle" type="button">使用地類別</button>
                                            <div class="dropdown-menu">
                                                <button class="dropdown-item" type="button" v-for="(i, idx) in outCity2" @click.stop>
                                                    <input type="checkbox" class="form-check-input" :id="'outCity2' + idx" v-model="searchForm.land.condition.outCity2[i]">
                                                    <label class="m-0 w-100" :for="'outCity2' + idx"p>(( i ))</label>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col w-200 w-as">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle custom-select on1 left" type="button"
                                id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                土地面積
                            </button>
                            <div class="dropdown-menu">
                                <form class="p3 pp row">
                                    <div class="col-sm-6">
                                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.condition.areaType">
                                            <option :value="idx" v-for="(i, idx) in areaTypeList">(( i ))</option>
                                        </select>
                                    </div>
                                    <div class="row v4">
                                        <input type="" class="form-control col-sm-3 v2" placeholder="0" v-model="searchForm.land.condition.landAreaLowerLimit">
                                        <label class="col-form-label la1" for="edit-text-name-id">坪-</label>
                                        <input type="" class="form-control col-sm-3 v2" placeholder="0" v-model="searchForm.land.condition.landAreaUpperLimit">
                                        <label class="col-form-label la1" for="edit-text-name-id">坪</label>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="w-80 float-end">
                        <button class="btn btn-primary btn1 w-81 btn002" data-toggle="collapse" href="#collapseExample"
                            role="button" aria-expanded="false" aria-controls="collapseExample">
                            進階
                        </button>
                    </div>
                    <div class="cw-125 float-end">
                        <button type="button" class="btn btn-primary btn001" @click="serverSearch()"><svg class="w-ab" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/>
                            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>搜尋</button>
                    </div>
                </div>

                <div class="collapse r2" id="collapseExample">
                    <div class="card card-body">
                        <div class="row row-cols-auto row1">
                            <label class="col-form-label w-80 text-center1" for="edit-text-name-id">使用狀況</label>
                            <div class="w-200 left">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#bs1').multiselect({
                                            // enableHTML: true,
                                            nonSelectedText: '權屬',
                                            buttonWidth: '180px',
                                            numberDisplayed: 2,
                                            onChange:(q,w)=>{ms[0]("searchForm.land.condition.ownership." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="bs1" multiple="multiple" class="form-select  custom-select col-sm-12 w-10" v-model="searchForm.land.condition.ownership">
                                    <option :value="k" v-for="(v, k) in ownerShopList">(( v ))</option>
                                </select>
                            </div>
                            <div class="w-200">
                                <select id="bs2" class="f1 form-select custom-select col-sm-12 w-10" v-model="searchForm.land.condition.ownershipType">
                                    <option :value="null">公有共有</option>
                                    <option :value="0">不拘</option>
                                    <option :value="1">排除</option>
                                    <option :value="2">只有</option>
                                </select>
                            </div>
                            <div class="w-200">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#enable').multiselect({
                                            nonSelectedText: '登記原因',
                                            buttonWidth: '180px',
                                            numberDisplayed: 6,
                                            onChange:(q,w)=>{ms[0]("searchForm.land.condition.registerReason." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="enable" multiple="multiple" class="form-select form-control col-sm-12 w-10" v-model="searchForm.land.condition.registerReason">
                                    <option :value="idx" v-for="(i, idx) in registerReasonList">(( i))</option>
                                </select>
                            </div>

                            <div class="w-200">
                                <!-- @@@@ -->
                                <div class="dropdown on1">
                                    <button class="btn dropdown-toggle custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        持有年限
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp row">
                                            <div class="col-sm-6">
                                                <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.other.holding_period">
                                                    <option :value="'[' + (searchForm.land.other.holding_period_l*12) + ',' + (searchForm.land.other.holding_period_u*12) + ']'">自訂</option>
                                                    <option value="[0,6]">半年內</option>
                                                    <option value="[0,12]">1年內</option>
                                                    <option value="[36,60]">3 ~ 5年內</option>
                                                    <option value="[60,120]">5 ~ 10年內</option>
                                                    <option value="[120,]">10 年以上</option>
                                                </select>
                                            </div>
                                            <div class="row v4">
                                                <input class="form-control col-sm-3 v2" placeholder="0" v-model="searchForm.land.other.holding_period_l" v-number="0">
                                                <label class="col-form-label la1" for="edit-text-name-id">年-</label>
                                                <input class="form-control col-sm-3 v2" placeholder="0" v-model="searchForm.land.other.holding_period_u" v-number="0">
                                                <label class="col-form-label la1" for="edit-text-name-id">年</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="w-200">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#bs3').multiselect({
                                            nonSelectedText: '國土區分',
                                            numberDisplayed: 6,
                                            buttonWidth: '180px',
                                            onChange:(q,w)=>{ms[0]("searchForm.land.region.national_land_zone." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="bs3" multiple="multiple" class="form-select form-control col" v-model="searchForm.land.region.national_land_zone">
                                    <option :value="idx" v-for="(i ,idx) in national_land_zoneList">(( i ))</option>
                                </select>
                            </div>
                        </div>

                        <div class="row row-cols-auto row1">
                            <label class="col-form-label w-80 text-center1" for="edit-text-name-id">面積價值</label>
                            <div class="w-200">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        公告現值
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="row pp2">
                                                <input type="" class="form-control col-sm-2 v2" placeholder="0" v-model="searchForm.land.condition.presentLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬-</label>
                                                <input type="" class="form-control col-sm-2 v2" placeholder="0" v-model="searchForm.land.condition.presentUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="w-200">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        個人持分總值
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="pp2 row">
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_valueLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬-</label>
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_valueUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬</label>

                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="w-200">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        個人持分總面積
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="pp2 row">
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_areaLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">坪-</label>
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_areaUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">坪</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row row-cols-auto row1">
                            <label class="col-form-label w-80 text-center1" for="edit-text-name-id">所有權人</label>
                            <div class="w-200">
                                <script type="text/javascript">
                                    $('#example-single').multiselect();
                                </script>
                                <select id="example-single" class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.age_range">
                                    <option :value="null">年齡區間</option>
                                    <option :value="0">民國前</option>
                                    <option :value="1">民國20年以前</option>
                                    <option :value="2">民國21~30年以前</option>
                                </select>
                            </div>
                            <div class="w-200">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#example-getting-started').multiselect({
                                            enableHTML: true,
                                            nonSelectedText: '國籍',
                                            buttonWidth: '180px',
                                            onChange:(q,w)=>{ms[0]("searchForm.land.other.country." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="example-getting-started" multiple="multiple"
                                    class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.country">
                                    <option value="ALL">不拘</option>
                                    <option value="TW">台灣</option>
                                    <option value="VN">越南</option>
                                    <option value="IN">印尼</option>
                                    <option value="CH">中國</option>
                                </select>
                            </div>

                            <div class="w-200">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        所有權人數
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="pp2 row">
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.condition.ownershipNumLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">人-</label>
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.condition.ownershipNumUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">人</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row row-cols-auto row1">
                            <label class="col-form-label w-80 text-center1" for="edit-text-name-id">其他設定</label>
                            <div class="w-200">
                                <select id="" class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.otherRemark">
                                    <option :value="null">他項標記</option>
                                    <option :value="idx" v-for="(i, idx) in otherRemarkList">(( i ))</option>
                                </select>
                            </div>
                            <div class="w-200">
                                <select class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.restrictedRegistration">
                                    <option :value="null">限制登記</option>
                                    <option :value="idx" v-for="(i, idx) in restrictedRegistrationList">(( i ))</option>
                                </select>
                            </div>
                            <div class="w-200 d-none">
                                <!-- @@@@ -->
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        lbkey
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp row">
                                            <div class="col-sm-6">
                                                <select
                                                    class="form-control custom-select col-sm-12 w-10">
                                                    <option value="DF" selected>單筆</option>
                                                    <option value="LG">多筆</option>
                                                    <option value="SM">區間</option>
                                                </select>
                                            </div>
                                            <div class="row v4">
                                                <input type="" class="form-control col-sm-5 v2"
                                                    placeholder="起">
                                                <label class="col-form-label la1" for="edit-text-name-id">～</label>
                                                <input type="" class="form-control col-sm-5 v2"
                                                    placeholder="迄">
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div v-if="showResult">
                <div class="a01">
                <ul class="nav nav-pills mb-3 p-tab" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active sbtn1" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
                            aria-controls="pills-home" aria-selected="true">
                            <svg class="svg01" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
                                fill="#FFFFFF">
                                <path d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                            </svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link sbtn2" id="pills-profile-tabs" data-toggle="pill" href="#pills-profile" role="tab"
                            aria-controls="pills-profile" aria-selected="false">
                            <svg class="svg02" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
                                fill="#FFFFFF">
                                <path d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                            </svg>
                        </a>
                    </li>
                </ul>
                <div class="h3" style="width: calc(100% - 150px);">
                    <template v-for="(op, opIdx) in getSearchOptionsList">
                        <span class="grey" v-if="opIdx">+</span> (( op ))
                    </template>
                </div>
                </div>
                <div class="tab-content width2" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                        <div class="row mntable">
                            <table class="table1 table-expandable">
                                <thead>
                                    <tr>
                                        <th scope="col" style="width:5%">縣市</th>
                                        <th scope="col" style="width:5%">行政區</th>
                                        <th scope="col" style="width:9%">段小段</th>
                                        <th scope="col" style="width:7%">地號</th>
                                        <th scope="col" style="width:7%">國土分區</th>
                                        <th scope="col" style="width:19%">使用分區</th>
                                        <th scope="col" style="width:22%">使用地類別</th>
                                        <th scope="col" style="width:7%">土地面積(坪)</th>
                                        <th scope="col" style="width:7%">公告現值</th>
                                        <th scope="col" style="width:3%">總公告</th>
                                        <th scope="col" style="width:3%">地上建物</th>
                                        <th scope="col" style="width:3%">權屬種類</th>
                                        <th scope="col" style="width:3%">所有權人</th>
                                    </tr>
                                </thead>
                                <tbody class="table-body">
                                    <tr class="tab-content" v-if="loading">
                                        <td class="p-4" colspan="14">
                                            <div class="loadingData">
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="tab-content" v-else-if="!searchResBox.length">
                                        <td class="p-4" colspan="14"><img style="height:217px;" src="/static/images/nodata.svg"></td>
                                    </tr>
                                    <template v-for="(data, dataIdx) in searchResBox" class="tablebg1">
                                        <tr data-node="treetable-1">
                                            <td data="縣市">
                                                <p>(( data[0].city_name || '(空白)' ))</p>
                                            </td>
                                            <td data="行政區">
                                                <p>(( data[0].area_name || '(空白)' ))</p>
                                            </td>
                                            <td data="段小段">
                                                <p>(( data[0].region_name || '(空白)' ))</p>
                                            </td>
                                            <td data="地號">
                                                <p>
                                                    <a v-if="data[0].is_valid" :href="'#' + data[0].region_name + data[0].lno" data-toggle="collapse">(( data[0].lno || '(空白)' ))</a>
                                                    <span v-else>(( data[0].lno || '(空白)' ))</span>
                                                </p>
                                            </td>
                                            <td data="國土分區">
                                                <p>(( data[0].national_land_zone || '(空白)' ))</p>
                                            </td>
                                            <td data="使用分區" class="left">
                                                <p>(( data[0].land_zone || '(空白)' ))</p>
                                            </td>
                                            <td data="使用地類別" class="left">
                                                <p>(( data[0].urban_name || '(空白)' ))</p>
                                            </td>
                                            <td data="土地面積">
                                                <p>(( (data[0].land_area / 3.30579).round(2) || '(空白)' ))</p>
                                            </td>
                                            <td data="公告現值">
                                                <p>(( data[0].land_notice_value?.chUnit() || '(空白)' ))</p>
                                            </td>
                                            <td data="總公告">
                                                <p>(( data[0].總公告?.chUnit() || '(空白)' ))</p>
                                            </td>
                                            <td data="地上建物">
                                                <p>(( data[0].build_num || '(空白)' ))</p>
                                            </td>
                                            <td data="權屬種類">
                                                <p>(( data[0].owner_type || '(空白)' ))</p>
                                            </td>
                                            <td data="所有權人">
                                                <p>(( data[0].regno.length || 0 ))</p>
                                            </td>
                                        </tr>
                                        <tr :id="data[0].region_name + data[0].lno" class="collapse cell-1 row-child tablebg2">
                                            <td colspan="15">
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th>登記次序</th>
                                                            <th>登記日期</th>
                                                            <th>登記原因</th>
                                                            <th>所有權人</th>
                                                            <th>統一編號</th>
                                                            <th>住址</th>
                                                            <th>出生日期</th>
                                                            <th>權利範圍</th>
                                                            <th>持分面積</th>
                                                            <th>持分坪數</th>
                                                            <th>持分現值</th>
                                                            <th>他項權利(其他註記)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="line in data">
                                                            <td data="登記次序">(( line.regno || '(空白)' ))</td>
                                                            <td data="登記日期">(( line.reg_date_str || '(空白)' ))</td>
                                                            <td data="登記原因">(( line.reg_reason_str || '(空白)' ))</td>
                                                            <td data="所有權人">(( line.name || '(空白)' ))</td>
                                                            <td data="統一編號">(( line.uid || '(空白)' ))</td>
                                                            <td data="住址">(( line.address_re || '(空白)' ))</td>
                                                            <td data="出生日期">(( line.bday || '(空白)' ))</td>
                                                            <td data="權利範圍">(( line.right_str || '(空白)' ))</td>
                                                            <td data="持分面積">(( line.shared_size || '(空白)' ))</td>
                                                            <td data="持分坪數">(( (line.shared_size / 3.30579).round(2) || '(空白)' ))</td>
                                                            <td data="持分現值(萬)">(( line.持分現值 || '(空白)' ))</td>
                                                            <td data="他項權利(其他註記)">
                                                                <p v-for="person in data.creditors_rights">(( person ))</p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                        <div class="footer1">
                            <div class="row">
                                <div class="input-group">
                                    <span class="input-group-text border-0" style="background-color: #f5f5f5;">每頁：</span>
                                    <select class="custom-select" v-model="onepageNum"><option v-for="i in pageNumList" :value="i">((i))</option></select>
                                    <span class="input-group-text border-0" style="background-color: #f5f5f5;">筆，共(( searchRes.length ))筆</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm">
                                    <nav aria-label="Page navigation example">
                                        <ul class="pagination">
                                            <li class="page-item">
                                                <span class="page-link" @click="nowPage--">上一頁</span>
                                            </li>
                                            <li class="page-item" :class="{active:nowPage==startPageBtn+i}" v-for="i in 9..minmax(1,totalPage)" @click="nowPage=startPageBtn+i">
                                                <span class="page-link">(( startPageBtn+i ))</span>
                                            </li>
                                            <li class="page-item">
                                                <span class="page-link" @click="nowPage++">下一頁</span>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <div class="row mntable">
                            <table class="table1 table-expandable">
                                <thead>
                                    <tr>
                                        <th scope="col" style="width:10%;">所有權人</th>
                                        <th scope="col" style="width:10%;">統一編號</th>
                                        <th scope="col" style="width:25%;">戶籍地址</th>
                                        <th scope="col" style="width:5;">出生日期</th>
                                        <th scope="col" style="width:10%;">土地總筆數</th>
                                        <th scope="col" style="width:5%;">持分總坪數</th>
                                        <th scope="col" style="width:5%;">持分總現值(萬)</th>
                                        <th scope="col" style="width:5%;">建物總筆數</th>
                                        <th scope="col" style="width:5%;">電話</th>
                                        <th scope="col" style="width:10%;">所有權註記</th>
                                        <th scope="col" style="width:10%;">身份標籤</th>
                                    </tr>
                                </thead>
                                <tbody class="table-body">
                                    <tr class="tab-content" v-if="loading">
                                        <td class="p-4" colspan="11">
                                            <div class="loadingData">
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="tab-content" v-else-if="!person_searchResBox.length">
                                        <td class="p-4" colspan="11"><img style="height:217px;" src="/static/images/nodata.svg"></td>
                                    </tr>
                                    <template v-for="(data, dataIdx) in person_searchResBox">
                                        <tr data-node="treetable-1">
                                            <td data="所有權人">
                                                <p><a :href="'#' + data._key" data-toggle="collapse">(( data[0].name || '(空白)' ))</a></p>
                                            </td>
                                            <td data="統一編號">
                                                <p>(( data[0].uid || '(空白)' ))</p>
                                            </td>
                                            <td data="戶籍地址" class="left">
                                                <p>(( data[0].address_re || '(空白)' ))</p>
                                            </td>
                                            <td data="出生日期">
                                                <p>(( data[0].bday || '(空白)' ))</p>
                                            </td>
                                            <td data="土地總筆數">
                                                <p>(( data[0].regno?.length || '(空白)' ))</p>
                                            </td>
                                            <td data="持分總坪數">
                                                <p>(( data[0].持分總評數 || '(空白)' ))</p>
                                            </td>
                                            <td data="持分總現值(萬)">
                                                <p>(( data[0].持分總現值 || '(空白)' ))</p>
                                            </td>
                                            <td data="建物總筆數">
                                                <p>(( data[0].建物總筆數 || '(空白)' ))</p>
                                            </td>
                                            <td data="電話">
                                                <p>(( data[0].電話 || '(空白)' ))</p>
                                            </td>
                                            <td data="所有權註記">
                                                <p>(( data[0].所有權註記 || '(空白)' ))</p>
                                            </td>
                                            <td data="身份標籤">
                                                <p>(( data[0].身份標籤 || '(空白)' ))</p>
                                            </td>
                                        </tr>
                                        <tr :id="data._key" class="collapse cell-1 row-child tablebg2">
                                            <td colspan="15">
                                                <table class="table11">
                                                    <thead>
                                                        <tr>
                                                            <th>縣市</th>
                                                            <th>行政區</th>
                                                            <th>段小段</th>
                                                            <th>地號</th>
                                                            <th>登記次序</th>
                                                            <th>登記日期</th>
                                                            <th>登記原因</th>
                                                            <th>土地面積</th>
                                                            <th>公告現值</th>
                                                            <th>權利範圍</th>
                                                            <th>持分坪數</th>
                                                            <th>持分現值(萬)</th>
                                                            <th>他項權利(其他註記)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="line in data">
                                                            <td data="縣市">(( line.city_name || '(空白)' ))</td>
                                                            <td data="行政區">(( line.area_name || '(空白)' ))</td>
                                                            <td data="段小段">(( line.region_name || '(空白)' ))</td>
                                                            <td data="地號">(( line._lbnum || '(空白)' ))</td>
                                                            <td data="登記次序">(( line.登記次序 || '(空白)' ))</td>
                                                            <td data="登記日期">(( line.reg_date_str || '(空白)' ))</td>
                                                            <td data="登記原因">(( line.reg_reason_str || '(空白)' ))</td>
                                                            <td data="土地面積">(( (line.land_area / 3.30579).round(2) || '(空白)' ))</td>
                                                            <td data="公告現值">(( line.land_notice_value || '(空白)' ))</td>
                                                            <td data="權利範圍">(( line.right_str || '(空白)' ))</td>
                                                            <td data="持分坪數">(( (line.shared_size / 3.30579).round(2) || '(空白)' ))</td>
                                                            <td data="持分現值">(( line.持分現值 || '(空白)' ))</td>
                                                            <td data="他項權利">(( line.他項權利 || '(空白)' ))</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                        <div class="footer1">
                            <div class="row">
                                <div class="input-group">
                                    <span class="input-group-text border-0" style="background-color: #f5f5f5;">每頁：</span>
                                    <select class="custom-select" v-model="person_onepageNum"><option v-for="i in person_pageNumList" :value="i">((i))</option></select>
                                    <span class="input-group-text border-0" style="background-color: #f5f5f5;">筆，共(( person_searchRes.length ))筆</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm">
                                    <nav aria-label="Page navigation example">
                                        <ul class="pagination">
                                            <li class="page-item">
                                                <span class="page-link" @click="person_nowPage--">上一頁</span>
                                            </li>
                                            <li class="page-item" :class="{active:person_nowPage==person_startPageBtn+i}" v-for="i in 9..minmax(1,person_totalPage)" @click="person_nowPage=person_startPageBtn+i">
                                                <span class="page-link">(( person_startPageBtn+i ))</span>
                                            </li>
                                            <li class="page-item">
                                                <span class="page-link" @click="person_nowPage++">下一頁</span>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="!showResult">
                <div class="row bg1">
                    <div class="col-sm-7 d-flex1">
                        <div class="align-self-center">
                            <h1 class="font-weight-bold mb-3">輕鬆幫您找出土地持有人</h1>
                            <h4 class="">搜尋土地開發範圍，輕鬆幫您找出土地持有人相關資訊</br>
                                幫助您精準鎖定關係人進一步推進成交！</h4>
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <img src="/static/images/slogan.svg">
                    </div>
                </div>
                <div class="row bg3">
                    <div class="col-sm-4">
                        <div class="bg2 d-flex justify-content-between">
                            <img class="align-self-start" src="/static/images/step0.svg">
                            <div class="align-self-center px-2">設定搜尋範圍 <span>&gt;</span></div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="bg2 bg4 d-flex justify-content-between">
                            <img class="align-self-start" src="/static/images/step1.svg">
                            <div class="align-self-center px-2">查看開發範圍 <span>&gt;</span></div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="bg2 bg5 d-flex justify-content-between">
                            <img class="align-self-start" src="/static/images/step2.svg">
                            <div class="align-self-center px-2">取得持有人情報</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <footer class="col-12 text-md-center footer">
        <p>COPYRIGHT © 2022元宏創新服務股份有限公司</p>
    </footer>
    {% endblock %}
    {% block script %}
    <script>
        $(function () {
            $("[data-submenu]").submenupicker();
            $(".dropdown-toggle").on("click", function () {
                $(this).toggleClass("on");
            });

            $(".dropdown").on("hide.bs.dropdown", function () {
                $(".dropdown-toggle").removeClass("on");
            });

            $(document).on("keypress", "input", function (e) {
                var code = e.keyCode || e.which;
                if (code == 27) {
                    $(".dropdown-toggle").removeClass("on");
                }
            });
        });
    </script>
    <script>
        var ms = [];
        const baseapp = Vue.createApp({
            delimiters: ['((', '))'],
            data() {
                return {
                    ownerShopList: {
                        natural:"自然人",
                        private:"私法人",
                        public:"公法人",
                        non_public:"非公有",
                        partially_public:"部分公有"
                    },
                    countryList:{
                        ALL: "不拘",
                        TW:"台灣",
                        VN:"越南",
                        IN:"印尼",
                        CH:"中國",
                    },
                    areaTypeList: ["不拘", "總面積", "持分面積", "平均持分"],
                    inCity: ['住宅區', '工業區', '商業區', '農業區', '風景區', '別墅區', '林業區', '文教區', '水岸發展區', '水域', '行水區', '行政區', '防風林區', '其他使用分區', '服務區', '河川區', '保存區', '保護區', '活動區', '倉庫區', '旅館區', '海濱浴場區', '動植物園區', '國家公園區', '眺望區', '野餐區', '魚塭區', '景觀區', '溫泉區', '葬儀業區', '遊樂區', '遊憩區', '漁業區', '營區', '露營區', '體育運動區', '鹽田區區', '觀光農場區'],
                    outCity: ['特定農業區', '一般農業區', '工業區', '鄉村區', '森林區', '山坡地保護區', '風景區', '國家公園區', '河川區', '海域區', '其他使用區或特定專區'],
                    outCity2: ['甲種建築用地', '乙種建築用地', '丙種建築用地', '丁種建築用地', '牧農用地', '林業用地', '養殖用地', '鹽業用地', '礦業用地', '窯業用地', '交通用地', '水利用地', '遊憩用地', '古蹟保存用地', '生態保護用地', '國土保安用地', '殯葬用地', '海域用地', '特定目的事業用地'],
                    national_land_zoneList: ['不拘', '城一', '城二之一', '城二之二', '城二之三', '城三', '農一', '農二', '農三', '農四', '國一', '國二', '國三', '國四', '海一之一', '海一之二', '海一之三', '海二', '海三', '未分類'],
                    registerReasonList: ["繼承", "贈與", "買賣", "交換", "重劃", "總登記", "分割", "調解", "拍賣", "信託", "合併", "其他"],
                    otherRemarkList: ["私設", "銀行二胎", "銀行", "租賃"],
                    restrictedRegistrationList: ["查封登記", "假扣押登記", "假處分登記", "破產登記", "其他依法律所為禁止處分登記"],
                    cityList: { "A": "臺北市", "C": "基隆市", "F": "新北市", "H": "桃園市", "O": "新竹市", "J": "新竹縣", "B": "臺中市", "K": "苗栗縣", "N": "彰化縣", "M": "南投縣", "P": "雲林縣", "D": "臺南市", "E": "高雄市", "I": "嘉義市", "Q": "嘉義縣", "T": "屏東縣", "G": "宜蘭縣", "U": "花蓮縣", "V": "臺東縣",/* "X": "澎湖縣", "W": "金門縣", "Z": "連江縣" */},
                    areaList: {},
                    sectionList:{},
                    planList: {},
                    showResult: 0,
                    loading: 0,
                    getSearchOptionsList: [],

                    pageNumList: [5, 10, 20, 50, 100],
                    onepageNum: 10,
                    startPageBtn: 0,
                    nowPage: 0,
                    totalPage: 1,
                    searchRes: [],
                    searchResBox: [],

                    person_pageNumList: [5, 10, 20, 50, 100],
                    person_onepageNum: 10,
                    person_startPageBtn: 0,
                    person_nowPage: 0,
                    person_totalPage: 1,
                    person_searchRes: [],
                    person_searchResBox: [],

                    searchForm:{
                        land:{
                            "region": {
                                "city": null, // 縣市
                                "area": null, // 行政區
                                "plan": null, // 計劃案
                                "section": null, // 段小段
                                "includeInvalid": 0, //包含失效
                                "land_number": "", // 地號
                                "national_land_zone": [], // 國土分區
                            },
                            "condition": {
                                "registerReason": { // 登記原因

                                },
                                "ownership": { //權屬
                                    "natural": 0,
                                    "private": 0,
                                    "public": 0,
                                    "non_public": 0,
                                    "partially_public": 0
                                },
                                "ownershipType": null, // 權屬種類 公同共有那些
                                "ownershipNumLowerLimit": 0, // 所有權人數 下限
                                "ownershipNumUpperLimit": 0, // 所有權人數 上限
                                "areaType": 0, // 土地面積 總面積那些
                                "landAreaLowerLimit": 0, // 土地面積 下限
                                "landAreaUpperLimit": 0, // 土地面積 上限
                                "inCity": {}, // 使用分區都內
                                "outCity": {}, // 使用分區都外 分區
                                "outCity2": {}, // 使用分區都外 地類別
                                "presentLowerLimit": 0, // 公告現值 下限
                                "presentUpperLimit": 0, // 公告現值 上限
                            },
                            "other": {
                                "otherRemark": null, // 他項標記
                                "restrictedRegistration": null, // 限制登記
                                "age_range": null,    // 年齡範圍
                                "country": {},      // 國籍
                                "p_part_valueLowerLimit": "", // 個人持分總值 下限
                                "p_part_valueUpperLimit": "", // 個人持分總值 上限
                                "p_part_areaLowerLimit": "", // 個人持分總面積 下限
                                "p_part_areaUpperLimit": "", // 個人持分總面積 上限
                                "holding_period": "", // 持有年限
                                "holding_period_l": 0, // 持有年限 下限
                                "holding_period_u": 0, // 持有年限 上限
                            }
                        }
                    },
                }
            },
            methods: {
                logout(){
                    new HTTPreq("/v_search/logout/", "fd").geta().then(rcv => {
                        var res = supfnc.toJSON(rcv.result);
                        if(res.status == "OK"){
                            window.location.href = "/";
                        }
                    });
                },
                getArea(city){
                    var T = this;
                    this.searchForm.land.region.area = null;
                    this.searchForm.land.region.plan = null;
                    this.searchForm.land.region.section = null;
                    if(!city || this.areaList[city]) return;
                    new HTTPreq("/v_search/get_area/?city=" + city).geta().then((rcv) => {
                        var res = supfnc.toJSON(rcv.result), data = {};
                        for(var i in res){
                            data[city + "_" + res[i].area_code] = res[i].area_name;
                        }
                        T.areaList[city] = data;
                    });
                },
                getSection(area){
                    var T = this;
                    this.searchForm.land.region.section = null;
                    if(!area || this.sectionList[area]) return;
                    new HTTPreq("/v_search/get_region/?area=" + area.slice(2,4)+ "&city=" + area[0]).geta().then((rcv) => {
                        var res = supfnc.toJSON(rcv.result), data = {};
                        for(var i in res){
                            data[res[i].car_code] = res[i].region_name;
                        }
                        T.sectionList[area] = data;
                    });
                },
                getPlan(area){
                    var T = this;
                    this.searchForm.land.region.plan = null;
                    if(!area || this.planList[area]) return;
                    new HTTPreq("/v_search/get_plan_name/", "fd").posta({area:area}).then((rcv) => {
                        var res = supfnc.toJSON(rcv.result), data = {};
                        for(var i in res.plan_name){
                            data[res.plan_name[i]] = res.nick_name[i];
                        }
                        T.planList[area] = data;
                    });
                },
                serverSearch(){
                    var T = this;
                    this.loading = 1;
                    this.showResult = 1;
                    if(!this.searchForm.land.region.city || !this.searchForm.land.region.area || (!this.searchForm.land.region.plan && !this.searchForm.land.region.section)) {
                        Swal.fire("請選擇至段小段或計劃案")
                        return;
                    }
                    T.searchRes = [];
                    T.person_searchRes = [];
                    T.searchResBox = [];
                    T.person_searchResBox = [];

                    this.searchForm.land.region.land_number = this.landbuildNumberFix(this.searchForm.land.region.land_number, "l").res.join(",");

                    new HTTPreq("/v_search/get_search_responseV3/", "fd").setHeaders({'Authorization': 'token {{ user_token }}'}).posta({lbtype: "L", searchForm: this.searchForm}).then((rcv) => {
                        T.loading = 0;
                        var res = supfnc.toJSON(rcv.result);
                        console.log(res);
                        var land_data = res.land_data, owner_data = res.owner_data;

                        for(var i in land_data){
                            T.searchRes.push(land_data[i]);
                        }
                        T.totalPage = Math.ceil(T.searchRes.length / T.onepageNum);
                        T.nowPage = 0;
                        Vue.nextTick(()=>{T.nowPage = 1;});

                        var tmp = {};
                        for(var i in owner_data){
                            owner_data[i]._key = "k" + i.replace(/[~!@#$%^&*()?/\\]/g, "");
                            T.person_searchRes.push(owner_data[i]);
                        }
                        T.person_totalPage = Math.ceil(T.person_searchRes.length / T.person_onepageNum);
                        T.person_nowPage = 0;
                        Vue.nextTick(()=>{T.person_nowPage = 1;});

                        T.getSearchOptionsList = T.getSearchOptions();
                    });
                },
                landbuildNumberFix(str, lbtype){
                    lb = ["b", "build"].includes(lbtype.toLowerCase()) ? [5, 3] : [4, 4];
                    var lbnum = str.replace(/\s/g, "").split(","), sublbnum, tmp, next;
                    var ok = true, res = [];
                    for(var i in lbnum){
                        next = false;
                        sublbnum = lbnum[i].split("~");
                        if(!lbnum[i]) continue;
                        if(sublbnum.length > 2) {
                            ok = false;
                            continue;
                        }
                        for(var j in sublbnum){
                            if(sublbnum[j].match(new RegExp(`^\\d{1,${lb[0]}}(-\\d{0,${lb[1]}})?$`))){
                                
                                tmp = sublbnum[j].split("-");
                                if(tmp.length > 2) {
                                    ok = false;
                                    next = true;
                                    break;
                                }
                                tmp[0] = parseInt(tmp[0]).zfill(lb[0]);
                                tmp[1] = parseInt(tmp[1] || 0).zfill(lb[1]);
                                res.push(tmp.join("-"));
                            }
                            else {
                                ok = false;
                                next = true;
                            }
                        }
                        if(sublbnum.length == 2 && !next){
                            tmp = res.pop();
                            res[res.length - 1] = [res.last(), tmp].join("~");
                        }
                    }
                    return {ok: ok, res: res};
                },
                multipleSelect: function(route, value){
                    var tmp = route.split("."), T = this, d = this;
                    for(var i=0; i<tmp.length-1; i++){
                        if(d[tmp[i]]) d = d[tmp[i]];
                    }
                    d[tmp.last()] = value;
                },
                clearInOutCitty(){
                    this.searchForm.land.condition.inCity = {};
                    this.searchForm.land.condition.outCity = {};
                    this.searchForm.land.condition.outCity2 = {};
                },
                getSearchOptions(){
                    var r = [
                        this.cityList[this.searchForm.land.region.city],
                        this.areaList[this.searchForm.land.region.city]?.[this.searchForm.land.region.area],
                        this.sectionList[this.searchForm.land.region.area]?.[this.searchForm.land.region.section] || this.planList[this.searchForm.land.region.area]?.[this.searchForm.land.region.plan]
                    ], tmp;
                    
                    
                    // 地號
                    if(this.searchForm.land.region.land_number) r.push("地號" + (this.searchForm.land.region.includeInvalid ? " (包含失效資料)" : "") + this.searchForm.land.region.land_number);
                    // 權屬
                    tmp = this.searchForm.land.condition.ownership.reduce((a,e,i) => {if(e) a.push(this.ownerShopList[i]); return a;}, []);
                    if(tmp.length) r.push(tmp.join(" "));
                    // 公同共有
                    tmp = ["不拘", "排除", "只有"].getV(this.searchForm.land.condition.ownershipType)
                    if(tmp) r.push(tmp + "公同共有");
                    // 使用分區
                    tmp = this.searchForm.land.condition.inCity.reduce((a,e,i) => {if(e) a.push(i); return a;}, []);
                    tmp = [...tmp, ...this.searchForm.land.condition.outCity.reduce((a,e,i) => {if(e) a.push(i); return a;}, [])];
                    tmp = [...tmp, ...this.searchForm.land.condition.outCity2.reduce((a,e,i) => {if(e) a.push(i); return a;}, [])];
                    if(tmp.length) r.push(tmp.join(" "));
                    // 登記原因
                    tmp = this.searchForm.land.condition.registerReason.reduce((a,e,i) => {if(e) a.push(this.registerReasonList[i]); return a;}, []);
                    for(var i in tmp) r.push(tmp[i] + "登記");
                    // 持有年限
                    tmp = JSON.parse(this.searchForm.land.other.holding_period);
                    if(tmp[0] == 0 && tmp[1] == 0){}
                    else if(tmp.length == 1) r.push("持有" + tmp[0]/12 + "年以上");
                    else if(tmp[0] == 0) r.push("持有" + tmp[1] % 12 ? tmp[1] + "個月內" : tmp[1]/12 + "年內");
                    else r.push("持有" + tmp[0]/12 + "年 ~ " + tmp[1]/12 + "年");
                    // 國土分區
                    tmp = this.searchForm.land.region.national_land_zone.reduce((a,e,i) => {if(e) a.push(this.national_land_zoneList[i]); return a;}, []);
                    if(tmp.length) r.push("國土" + tmp.join(" ") + "區");
                    // 土地面積
                    if(this.searchForm.land.condition.landAreaLowerLimit || this.searchForm.land.condition.landAreaUpperLimit){
                        r.push("土地面積 " + this.searchForm.land.condition.landAreaLowerLimit + "坪 ~ " + this.searchForm.land.condition.landAreaUpperLimit + "坪");
                    }
                    // 公告現值
                    if(this.searchForm.land.condition.presentLowerLimit || this.searchForm.land.condition.presentUpperLimit){
                        r.push("現值 " + this.searchForm.land.condition.presentLowerLimit + "萬 ~ " + this.searchForm.land.condition.presentUpperLimit + "萬");
                    }
                    // 個人持分總值
                    if(this.searchForm.land.other.p_part_valueLowerLimit || this.searchForm.land.other.p_part_valueUpperLimit){
                        r.push("持分總值 " + this.searchForm.land.other.p_part_valueLowerLimit + "萬 ~ " + this.searchForm.land.other.p_part_valueUpperLimit + "萬");
                    }
                    // 年齡區間
                    tmp = ["民國前","民國20年以前","民國21~30年以前"].getV("searchForm.land.other.age_range");
                    if(tmp) r.push(tmp);
                    // 國籍
                    tmp = this.searchForm.land.other.country.reduce((a,e,i) => {if(e) a.push(this.countryList[i]); return a;}, []);
                    if(tmp.length) r.push(tmp.join(" "));
                    // 所有權人數
                    if(this.searchForm.land.condition.ownershipNumLowerLimit || this.searchForm.land.condition.ownershipNumUpperLimit){
                        r.push("所有權人數 " + this.searchForm.land.condition.ownershipNumLowerLimit + "人 ~ " + this.searchForm.land.condition.ownershipNumUpperLimit + "人");
                    }
                    // 他項標記
                    tmp = this.otherRemarkList.getV(this.searchForm.land.other.otherRemark);
                    if(tmp) r.push(tmp);
                    // 限制登記
                    tmp = this.restrictedRegistrationList.getV(this.searchForm.land.other.restrictedRegistration);
                    if(tmp) r.push(tmp);

                    return r;
                },
                selectPage(nV, oV){
                    var data;
                    this.nowPage = nV.minmax(1, this.totalPage);
                    this.startPageBtn = (this.nowPage-4).minmax(1, Math.max(this.totalPage-8, 1)) - 1;
                    this.searchResBox.length = 0;
                    for(var i=0; i<this.onepageNum; i++){
                        data = this.searchRes[(nV-1) * this.onepageNum + i];
                        if(!data) break;
                        this.searchResBox.push(data);
                    }
                },
                person_selectPage(nV, oV){
                    var data;
                    this.person_nowPage = nV.minmax(1, this.person_totalPage);
                    this.person_startPageBtn = (this.person_nowPage-4).minmax(1, Math.max(this.person_totalPage-8, 1)) - 1;
                    this.person_searchResBox.length = 0;
                    for(var i=0; i<this.person_onepageNum; i++){
                        data = this.person_searchRes[(nV-1) * this.person_onepageNum + i];
                        if(!data) break;
                        this.person_searchResBox.push(data);
                    }
                },
            },
            mounted(){
                ms[0] = this.multipleSelect;
            },
            created(){},
            updated(){},
            beforeUpdate(){},
            watch:{
                nowPage:{
                    handler(nV, oV){
                        this.selectPage(nV, oV);
                    }
                },
                onepageNum:{
                    handler(nV, oV){
                        this.totalPage = Math.ceil(this.searchRes.length / nV);
                        this.selectPage(this.nowPage, oV);
                    }
                },
                person_nowPage:{
                    handler(nV, oV){
                        this.person_selectPage(nV, oV);
                    },
                },
                person_onepageNum:{
                    handler(nV, oV){
                        this.person_totalPage = Math.ceil(this.person_searchRes.length / nV);
                        this.person_selectPage(this.person_nowPage, oV);
                    },
                },
                "searchForm.land.other.holding_period_l":{
                    handler(nV, oV){
                        this.searchForm.land.other.holding_period = `[${nV*12},${this.searchForm.land.other.holding_period_u*12}]`;
                    },
                    immediate: true,
                },
                "searchForm.land.other.holding_period_u":{
                    handler(nV, oV){
                        this.searchForm.land.other.holding_period = `[${this.searchForm.land.other.holding_period_l*12},${nV*12}]`;
                    }
                },
            }
        });

        // test
        // new HTTPreq("/v_search/get_search_responseV3/", "fd").setHeaders({'Authorization': 'token a021bd4735ebec44a3564cea9390d91aadfdabff'}).posta({lbtype: "L", searchForm: vm.searchForm, fake_data: true}).then((rcv) => {
        //     var res = supfnc.toJSON(rcv.result);
        //     console.log(res);
        // });
    </script>
    {% endblock %}
</body>

</html>