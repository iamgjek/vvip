{% extends 'base.html' %}
<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title></title>
    <link rel="icon" type="image/ico" href="/static/favicon.ico">
    <link rel="shortcut icon" type="image/ico" href="/static/favicon.ico">
    <!-- sunnylogin -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/css/bootstrap-multiselect.min.css"
        rel="stylesheet">
    <link href="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/jquery-peeper.css">
    <link rel="stylesheet" href="/static/css/index.css">

    <script type="text/javascript" src="http://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/js/bootstrap-multiselect.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-submenu/3.0.1/js/bootstrap-submenu.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.js"></script>
    <script src="/static/js/index.js"></script>
    <script src="/static/js/jquery-peeper.js"></script>
    <script>
        $(function () {
            $("#password1").peeper({
                mask: false,
                showPasswordCss: 'fa fa-eye',
                showCopyBtn: false
            });
        });
    </script>
    {% endblock %}
</head>

<body>
    {% block body %}
    <div id="vue_app" class="cont">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand logo1" href="#"></a>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item bi"><a href="#">土地開發</a></li>
                    </ol>
                </nav>
            </div>
            <form class="d-flex"><a href="#" type="button" class="dropdown-toggle" data-bs-toggle="dropdown"
                    aria-expanded="false">uswe name</a>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                        <a href="/accounts/logout/" id="buttonForLogout" class="btn dropdown-item">
                            <img src="/static/images/返回.png" style="width: 24px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;登出</a>
                    </li>
                </ul>
            </form>
        </nav>
        <div class="container wrap">
            <nav aria-label="breadcrumb" class="bb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">首頁</a></li>
                    <li class="breadcrumb-item" :class="{active: !showResault}">土地開發</li>
                    <li class="breadcrumb-item active" v-if="showResault">搜尋結果</li>
                </ol>
            </nav>
            <div class="row r1">
                <div class="row">
                    <label class="col-form-label col col-width" for="edit-text-name-id">搜尋</label>
                    <div class="col-sm-auto">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.city" @change="getArea(searchForm.land.region.city)">
                            <option :value="null" selected>縣市</option>
                            <option :value="key" v-for="(value, key) in cityList"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col-sm-auto">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.area" @change="getSection(searchForm.land.region.area), getPlan(searchForm.land.region.area)">
                            <option :value="null" selected>行政區</option>
                            <option :value="key" v-for="(value, key) in areaList[searchForm.land.region.city]"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col-sm-auto" style="width:121px;">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.section" @change="searchForm.land.region.plan=null">
                            <option :value="null" selected>段小段</option>
                            <option :value="key" v-for="(value, key) in sectionList[searchForm.land.region.area]"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col-sm-auto" style="width:121px;">
                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.region.plan" @change="searchForm.land.region.section=null">
                            <option :value="null" selected>計劃案</option>
                            <option :value="key" v-for="(value, key) in planList[searchForm.land.region.area]"> ((value)) </option>
                        </select>
                    </div>
                    <div class="col-sm-auto">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle  custom-select left" type="button"
                                id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                地號
                            </button>
                            <div class="dropdown-menu">
                                <form class="px-4 py-3 row pp">
                                    <!-- @@@@ -->
                                    <div class="form-group col-sm-6">
                                        <select class="form-control custom-select col-sm-12 w-10">
                                            <option value="DF" selected>單筆</option>
                                            <option value="LG">多筆</option>
                                            <option value="SM">區間</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-sm-6 pp1">
                                        <input type="checkbox" class="form-check-input" id="dropdownCheck" v-model="searchForm.land.region.includeInvalid">
                                        <label class="form-check-label" for="dropdownCheck">包含失效資料</label>
                                    </div>
                                    <div class="form-check col-sm-12 pp2">
                                        <input type="password" class="form-control" placeholder="地號" v-model="searchForm.land.region.land_number">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-auto">
                        <!-- @@@@ -->
                        <div class="dropdown">
                            <button class="btn dropdown-toggle custom-select on on1 left" type="button"
                                data-toggle="dropdown" data-submenu>
                                使用分區
                            </button>
                            <div class="dropdown-menu">
                                <div class="dropdown dropright dropdown-submenu">
                                    <button class="dropdown-item" type="button">不拘</button>
                                </div>
                                <div class="dropdown dropright dropdown-submenu">
                                    <button class="dropdown-item dropdown-toggle" type="button">都內</button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item" type="button" v-for="(i, idx) in inCity" @click.stop>
                                            <input type="checkbox" class="form-check-input" :id="'inCity' + idx">
                                            <label class="m-0 w-100" :for="'inCity' + idx">(( i ))</label>
                                        </button>
                                    </div>
                                </div>
                                <div class="dropdown dropright dropdown-submenu">
                                    <button class="dropdown-item dropdown-toggle" type="button">都外</button>
                                    <div class="dropdown-menu">
                                        <div class="dropdown dropright dropdown-submenu">
                                            <button class="dropdown-item dropdown-toggle" type="button">使用分區</button>
                                            <div class="dropdown-menu">
                                                <button class="dropdown-item" type="button" v-for="(i, idx) in outCity" @click.stop>
                                                    <input type="checkbox" class="form-check-input" :id="'outCity' + idx">
                                                    <label class="m-0 w-100" :for="'outCity' + idx">(( i ))</label>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="dropdown dropright dropdown-submenu">
                                            <button class="dropdown-item dropdown-toggle" type="button">使用地類別</button>
                                            <div class="dropdown-menu">
                                                <button class="dropdown-item" type="button" v-for="(i, idx) in outCity2" @click.stop>
                                                    <input type="checkbox" class="form-check-input" :id="'outCity2' + idx">
                                                    <label class="m-0 w-100" :for="'outCity2' + idx"p>(( i ))</label>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-auto">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle custom-select on1 left" type="button"
                                id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                土地面積
                            </button>
                            <div class="dropdown-menu">
                                <form class="p3 pp row">
                                    <div class="col-sm-6">
                                        <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.land_area_type">
                                            <option :value="">總面積</option>
                                            <option :value="">持分面積</option>
                                            <option :value="">平均持分 </option>
                                        </select>
                                    </div>
                                    <div class="row v4">
                                        <input type="" class="form-control col-sm-3 v2" placeholder="0" v-model="searchForm.land.condition.landAreaLowerLimit">
                                        <label class="col-form-label la1" for="edit-text-name-id">坪-</label>
                                        <input type="" class="form-control col-sm-3 v2" placeholder="0" v-model="searchForm.land.condition.landAreaUpperLimit">
                                        <label class="col-form-label la1" for="edit-text-name-id">坪</label>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto">
                        <button class="btn btn-primary btn1" data-toggle="collapse" href="#collapseExample"
                            role="button" aria-expanded="false" aria-controls="collapseExample">
                            進階
                        </button>
                    </div>
                    <div class="col-auto">
                        <button type="button" class="btn btn-primary" @click="serverSearch()">搜尋</button>
                    </div>
                </div>

                <div class="collapse" id="collapseExample">
                    <div class="card card-body">
                        <div class="row row-cols-auto row1">
                            <label class="col-form-label col col-width" for="edit-text-name-id">使用狀況</label>
                            <div class="col">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#bs1').multiselect({
                                            // enableHTML: true,
                                            nonSelectedText: '權屬',
                                            buttonWidth: '170px',
                                            numberDisplayed: 2,
                                            onChange:(q,w)=>{ms[0]("searchForm.land.condition.ownership." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="bs1" multiple="multiple" class="form-select  custom-select col-sm-12 w-10" v-model="searchForm.land.condition.ownership" @change="cc(123)">
                                    <option value="natural">自然人</option>
                                    <option value="private">私法人</option>
                                    <option value="public">公法人</option>
                                    <option value="non_public">非公有</option>
                                    <option value="partially_public">部分公有</option>
                                </select>
                            </div>
                            <div class="col">
                                <select id="bs2" class="f1 form-select custom-select col-sm-12 w-10" v-model="searchForm.land.condition.ownershipType">
                                    <option :value="null">公有共有</option>
                                    <option :value="0">不拘</option>
                                    <option :value="1">排除</option>
                                    <option :value="2">只有</option>
                                </select>
                            </div>
                            <div class="col">
                                <script type="text/javascript">
                                    // @@@@
                                    $(document).ready(function () {
                                        $('#enable').multiselect({
                                            nonSelectedText: '登記原因',
                                            buttonWidth: '170px',
                                            numberDisplayed: 6,
                                            onChange:(q,w)=>{ms[0]("searchForm.land.condition.registerReason." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="enable" multiple="multiple" class="form-select form-control col-sm-12 w-10" v-model="searchForm.land.condition.registerReason">
                                    <option value="">不拘</option>
                                    <option value="">繼承</option>
                                    <option value="">贈與</option>
                                    <option value="">買賣</option>
                                    <option value="">交換</option>
                                    <option value="">重劃</option>
                                    <option value="">總登記</option>
                                    <option value="">分割</option>
                                    <option value="">調解</option>
                                    <option value="">拍賣</option>
                                    <option value="">信託</option>
                                    <option value="">合併</option>
                                    <option value="">其他</option>
                                </select>
                            </div>

                            <div class="col">
                                <div class="dropdown on1">
                                    <button class="btn dropdown-toggle custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        持有年限
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp row">
                                            <div class="col-sm-6">
                                                <select class="form-control custom-select col-sm-12 w-10" v-model="searchForm.land.other.holding_period">
                                                    <option value="" selected>半年內</option>
                                                    <option value="">1年內</option>
                                                    <option value="">3 ~ 5年內</option>
                                                    <option value="">5 ~ 10年內</option>
                                                    <option value="">10 年以上</option>
                                                </select>
                                            </div>
                                            <div class="row v4">
                                                <!-- @@@@ -->
                                                <input type="" class="form-control col-sm-3 v2" placeholder="0">
                                                <label class="col-form-label la1" for="edit-text-name-id">年-</label>
                                                <input type="" class="form-control col-sm-3 v2" placeholder="0">
                                                <label class="col-form-label la1" for="edit-text-name-id">年</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="col on1">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#bs3').multiselect({
                                            nonSelectedText: '國土區分',
                                            numberDisplayed: 6,
                                            buttonWidth: '170px',
                                            onChange:(q,w)=>{ms[0]("searchForm.land.region.national_land_zone." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="bs3" multiple="multiple" class="form-select form-control col" v-model="searchForm.land.region.national_land_zone">
                                    <option :value="idx" v-for="(i ,idx) in national_land_zone">(( i ))</option>
                                </select>
                            </div>
                        </div>

                        <div class="row row-cols-auto row1">
                            <label class="col-form-label col col-width" for="edit-text-name-id">面積價值</label>
                            <div class="col">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        公告現值
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="row pp2">
                                                <input type="" class="form-control col-sm-2 v2" placeholder="0" v-model="searchForm.land.condition.presentLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬-</label>
                                                <input type="" class="form-control col-sm-2 v2" placeholder="0" v-model="searchForm.land.condition.presentUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="col">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        個人持分總值
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="pp2 row">
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_valueLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬-</label>
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_valueUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">萬</label>

                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="col">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        個人持分總面積
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="pp2 row">
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_areaLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">坪-</label>
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.other.p_part_areaUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">坪</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row row-cols-auto row1">
                            <label class="col-form-label col col-width" for="edit-text-name-id">所有權人</label>
                            <div class="col">
                                <script type="text/javascript">
                                    $('#example-single').multiselect();
                                </script>
                                <select id="example-single" class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.age_range">
                                    <option :value="null">年齡區間</option>
                                    <option :value="0">民國前</option>
                                    <option :value="1">民國20年以前</option>
                                    <option :value="2">民國21~30年以前</option>
                                </select>
                            </div>
                            <div class="col">
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        $('#example-getting-started').multiselect({
                                            enableHTML: true,
                                            nonSelectedText: '國籍',
                                            buttonWidth: '170px',
                                            onChange:(q,w)=>{ms[0]("searchForm.land.other.country." + q[0].value, w)}
                                        });
                                    });
                                </script>
                                <select id="example-getting-started" multiple="multiple"
                                    class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.country">
                                    <option :value="null">不拘</option>
                                    <option value="TW">台灣</option>
                                    <option value="VN">越南</option>
                                    <option value="IN">印尼</option>
                                    <option value="CH">中國</option>
                                </select>
                            </div>

                            <div class="col">
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        所有權人數
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp">
                                            <div class="pp2 row">
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.condition.ownershipNumLowerLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">人-</label>
                                                <input type="" class="form-control col-sm-2" placeholder="0" v-model="searchForm.land.condition.ownershipNumUpperLimit">
                                                <label class="col-form-label la1" for="edit-text-name-id">人</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row row-cols-auto row1">
                            <label class="col-form-label col col-width" for="edit-text-name-id">其他設定</label>
                            <div class="col">
                                <select id="" class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.otherRemark">
                                    <option :value="0">他項標記</option>
                                    <option :value="1">私設</option>
                                    <option :value="2">銀行二胎</option>
                                    <option :value="3">銀行</option>
                                    <option :value="4">租賃</option>
                                </select>
                            </div>
                            <div class="col">
                                <select class="form-select custom-select col-sm-12 w-10" v-model="searchForm.land.other.restrictedRegistration">
                                    <option :value="0">限制登記</option>
                                    <option :value="1">查封登記</option>
                                    <option :value="2">假扣押登記</option>
                                    <option :value="3">假處分登記</option>
                                    <option :value="4">破產登記</option>
                                    <option :value="5">其他依法律所為禁止處分登記</option>
                                </select>
                            </div>
                            <div class="col">
                                <!-- @@@@ -->
                                <div class="dropdown">
                                    <button class="btn dropdown-toggle  custom-select left" type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        lbkey
                                    </button>
                                    <div class="dropdown-menu">
                                        <form class="p3 pp row">
                                            <div class="col-sm-6">
                                                <select
                                                    class="form-control custom-select col-sm-12 w-10">
                                                    <option value="DF" selected>單筆</option>
                                                    <option value="LG">多筆</option>
                                                    <option value="SM">區間</option>
                                                </select>
                                            </div>
                                            <div class="row v4">
                                                <input type="" class="form-control col-sm-5 v2"
                                                    placeholder="起">
                                                <label class="col-form-label la1" for="edit-text-name-id">～</label>
                                                <input type="" class="form-control col-sm-5 v2"
                                                    placeholder="迄">
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="showResault">
                <ul class="nav nav-pills mb-3 p-tab" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
                            aria-controls="pills-home" aria-selected="true">
                            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
                                fill="#FFFFFF">
                                <path d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                            </svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
                            aria-controls="pills-profile" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px"
                                fill="#FFFFFF">
                                <path d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                            </svg>
                        </a>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                        <div class="h3">桃園市<span class="grey">+</span>桃園區<span class="grey">+</span>和平段<span
                                class="grey">+</span>商業區<span class="grey">+</span>總面積20-30坪</div>
                        <div class="row" style="display: block;max-height: 50rem;overflow-y: auto;">
                            <table class="table1 table-hover table-expandable">
                                <thead>
                                    <tr>
                                        <th scope="col">縣市</th>
                                        <th scope="col">行政區</th>
                                        <th scope="col">段小段</th>
                                        <th scope="col">地號</th>
                                        <th scope="col">國土分區</th>
                                        <th scope="col">使用分區</th>
                                        <th scope="col">使用地類別</th>
                                        <th scope="col">土地面積</th>
                                        <th scope="col">公告現值</th>
                                        <th scope="col">總公告(萬)</th>
                                        <th scope="col">地上建物</th>
                                        <th scope="col">權屬種類</th>
                                        <th scope="col">所有權人</th>
                                        <th scope="col">他項權利人</th>
                                    </tr>
                                </thead>
                                <tbody class="table-body">
                                    <template v-for="(data, dataIdx) in searchResBox">
                                        <tr data-node="treetable-1">
                                            <td data="縣市">
                                                <p>(( data[0].city_name ))</p>
                                            </td>
                                            <td data="行政區">
                                                <p>(( data[0].area_name ))</p>
                                            </td>
                                            <td data="段小段">
                                                <p>(( data[0].region_name ))</p>
                                            </td>
                                            <td data="地號">
                                                <p><a :href="'#' + data.region_name + data._lbnum" data-toggle="collapse">(( data._lbnum ))</a></p>
                                            </td>
                                            <td data="國土分區">
                                                <p>(( data[0].national_land_zone || '(空白)' ))</p>
                                            </td>
                                            <td data="使用分區">
                                                <p>(( data[0].使用分區 || '(空白)' ))</p>
                                            </td>
                                            <td data="使用地類別">
                                                <p>(( data[0].使用地類別 || '(空白)' ))</p>
                                            </td>
                                            <td data="土地面積">
                                                <p>(( data[0].land_area ))</p>
                                            </td>
                                            <td data="公告現值">
                                                <p>(( data[0].land_notice_value ))</p>
                                            </td>
                                            <td data="總公告(萬)">
                                                <p>(( data[0].總公告 ))</p>
                                            </td>
                                            <td data="地上建物">
                                                <p>(( data[0].build_num ))</p>
                                            </td>
                                            <td data="權屬種類">
                                                <p>(( data[0].權屬種類 ))</p>
                                            </td>
                                            <td data="所有權人">
                                                <p>(( data[0].name ))</p>
                                            </td>
                                            <td data="他項權利人">
                                                <p>(( data[0].他項權利人 ))</p>
                                            </td>
                                        </tr>
                                        <tr :id="data.region_name + data._lbnum" class="collapse cell-1 row-child">
                                            <td colspan="15">
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th>登記次序</th>
                                                            <th>登記日期</th>
                                                            <th>登記原因</th>
                                                            <th>所有權人</th>
                                                            <th>統一編號</th>
                                                            <th>住址</th>
                                                            <th>出生日期</th>
                                                            <th>權利範圍</th>
                                                            <th>持分面積</th>
                                                            <th>持分坪數</th>
                                                            <th>持分現值(萬)</th>
                                                            <th>他項權利(其他註記)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="line in data">
                                                            <td data="登記次序">(( line.登記次序 ))</td>
                                                            <td data="登記日期">(( line.reg_date_str ))</td>
                                                            <td data="登記原因">(( line.reg_reason_str ))</td>
                                                            <td data="所有權人">(( line.name ))</td>
                                                            <td data="統一編號">(( line.uid ))</td>
                                                            <td data="住址">(( line.address_re ))</td>
                                                            <td data="出生日期">(( line.出生日期 ))</td>
                                                            <td data="權利範圍">(( line.right_str ))</td>
                                                            <td data="持分面積">(( line.shared_size * 3.30579 ))</td>
                                                            <td data="持分坪數">(( line.shared_size ))</td>
                                                            <td data="持分現值(萬)">(( line.持分現值 ))</td>
                                                            <td data="他項權利(其他註記)">(( line.他項權利 ))</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                        <div class="footer1">
                            <div class="row">
                                <div class="col-sm">
                                    <nav aria-label="Page navigation example">
                                        <ul class="pagination">
                                            <li class="page-item">
                                                <span class="page-link" @click="nowPage--">上一頁</span>
                                            </li>
                                            <li class="page-item" :class="{active:nowPage==startPageBtn+i}" v-for="i in 3..minmax(1,totalPage)" @click="nowPage=startPageBtn+i">
                                                <span class="page-link">(( startPageBtn+i ))</span>
                                            </li>
                                            <li class="page-item">
                                                <span class="page-link" @click="nowPage++">下一頁</span>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
    
                    </div>
                    <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <div class="h3">桃園市<span class="grey">+</span>桃園區<span class="grey">+</span>和平段<span
                                class="grey">+</span>商業區<span class="grey">+</span>總面積20-30坪</div>
                        <div class="row" style="display: block;max-height: 50rem;overflow-y: auto;">
                            <table class="table1 table-hover table-expandable">
                                <thead>
                                    <tr>
                                        <th scope="col">所有權人</th>
                                        <th scope="col">統一編號</th>
                                        <th scope="col">戶籍地址</th>
                                        <th scope="col">出生日期</th>
                                        <th scope="col">土地總比數</th>
                                        <th scope="col">持分總評數</th>
                                        <th scope="col">持分總現值(萬)</th>
                                        <th scope="col">建物總筆數</th>
                                        <th scope="col">電話</th>
                                        <th scope="col">所有權註記</th>
                                        <th scope="col">身份標籤</th>
                                    </tr>
                                </thead>
                                <tbody class="table-body">
                                    <template v-for="(data, dataIdx) in person_searchResBox">
                                        <tr data-node="treetable-1">
                                            <td data="所有權人">
                                                <p><a :href="'#'+data._key" data-toggle="collapse">(( data.name ))</a></p>
                                            </td>
                                            <td data="統一編號">
                                                <p>(( data.uid ))</p>
                                            </td>
                                            <td data="戶籍地址">
                                                <p>(( data.戶籍地址 ))</p>
                                            </td>
                                            <td data="出生日期">
                                                <p>(( data.出生日期 ))</p>
                                            </td>
                                            <td data="土地總比數">
                                                <p>(( data.土地總比數 ))</p>
                                            </td>
                                            <td data="持分總評數">
                                                <p>(( data.持分總評數 ))</p>
                                            </td>
                                            <td data="持分總現值(萬)">
                                                <p>(( data.持分總現值 ))</p>
                                            </td>
                                            <td data="建物總筆數">
                                                <p>(( data.建物總筆數 ))</p>
                                            </td>
                                            <td data="電話">
                                                <p>(( data.電話 ))</p>
                                            </td>
                                            <td data="所有權註記">
                                                <p>(( data.所有權註記 ))</p>
                                            </td>
                                            <td data="身份標籤">
                                                <p>(( data.身份標籤 ))</p>
                                            </td>
                                        </tr>
                                        <tr :id="data._key" class="collapse cell-1 row-child">
                                            <td colspan="15">
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th>縣市</th>
                                                            <th>行政區</th>
                                                            <th>段小段</th>
                                                            <th>地號</th>
                                                            <th>登記次序</th>
                                                            <th>登記日期</th>
                                                            <th>登記原因</th>
                                                            <th>土地面積</th>
                                                            <th>公告現值</th>
                                                            <th>權利範圍</th>
                                                            <th>持分坪數</th>
                                                            <th>持分現值(萬)</th>
                                                            <th>他項權利(其他註記)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td data="縣市">(( data.city_name ))</td>
                                                            <td data="行政區">(( data.area_name ))</td>
                                                            <td data="段小段">(( data.region_name ))</td>
                                                            <td data="地號">(( data._lbnum ))</td>
                                                            <td data="登記次序">(( data.登記次序 ))</td>
                                                            <td data="登記日期">(( data.reg_date_str ))</td>
                                                            <td data="登記原因">(( data.reg_reason_str ))</td>
                                                            <td data="土地面積">(( data.land_area ))</td>
                                                            <td data="公告現值">(( data.land_notice_value ))</td>
                                                            <td data="權利範圍">(( data.right_str ))</td>
                                                            <td data="持分坪數">(( data.shared_size ))</td>
                                                            <td data="持分現值">(( data.持分現值 ))</td>
                                                            <td data="他項權利">(( data.他項權利 ))</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                        <div class="footer1">
                            <div class="row">
                                <div class="col-sm">
                                    <nav aria-label="Page navigation example">
                                        <ul class="pagination">
                                            <li class="page-item">
                                                <span class="page-link" @click="person_nowPage--">上一頁</span>
                                            </li>
                                            <li class="page-item" :class="{active:person_nowPage==person_startPageBtn+i}" v-for="i in 3..minmax(1,person_totalPage)" @click="person_nowPage=person_startPageBtn+i">
                                                <span class="page-link">(( startPageBtn+i ))</span>
                                            </li>
                                            <li class="page-item">
                                                <span class="page-link" @click="person_nowPage++">下一頁</span>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="!showResault">
                <div class="row bg1">
                    <div class="col-sm-7 d-flex">
                        <div class="align-self-center">
                            <h1 class="font-weight-bold mb-3">輕鬆幫您找出土地持有人</h1>
                            <h4 class="">搜尋土地開發範圍，輕鬆幫您找出土地持有人相關資訊
                                幫助您精準鎖定關係人進一步推進成交！</h4>
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <img src="/static/images/slogan.svg">
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <div class="bg2 d-flex justify-content-between">
                            <img class="align-self-start" src="/static/images/step0.svg">
                            <span class="font-weight-bold align-self-center px-2">設定搜尋範圍 <span>&gt;</span></span>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="bg2 d-flex justify-content-between">
                            <img class="align-self-start" src="/static/images/step1.svg">
                            <span class="font-weight-bold align-self-center px-2">查看開發範圍 <span>&gt;</span></span>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="bg2 d-flex justify-content-between">
                            <img class="align-self-start" src="/static/images/step2.svg">
                            <span class="font-weight-bold align-self-center px-2">取得池有人情報</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <footer class="col-12 text-md-center footer">
        <p>COPYRIGHT © 2022元宏創新服務股份有限公司</p>
    </footer>
    {% endblock %}
    {% block script %}
    <script>
        $(function () {
            $("[data-submenu]").submenupicker();
            $(".dropdown-toggle").on("click", function () {
                $(this).toggleClass("on");
            });

            $(".dropdown").on("hide.bs.dropdown", function () {
                $(".dropdown-toggle").removeClass("on");
            });

            $(document).on("keypress", "input", function (e) {
                var code = e.keyCode || e.which;
                if (code == 27) {
                    $(".dropdown-toggle").removeClass("on");
                }
            });
        });
    </script>
    <script>
        var ms = [];
        const baseapp = Vue.createApp({
            delimiters: ['((', '))'],
            data() {
                return {
                    inCity: ['住宅區', '工業區', '商業區', '農業區', '風景區', '別墅區', '林業區', '文教區', '水岸發展區', '水域', '行水區', '行政區', '防風林區', '其他使用分區', '服務區', '河川區', '保存區', '保護區', '活動區', '倉庫區', '旅館區', '海濱浴場區', '動植物園區', '國家公園區', '眺望區', '野餐區', '魚塭區', '景觀區', '溫泉區', '葬儀業區', '遊樂區', '遊憩區', '漁業區', '營區', '露營區', '體育運動區', '鹽田區區', '觀光農場區'],
                    outCity: ['特定農業區', '一般農業區', '工業區', '鄉村區', '森林區', '山坡地保護區', '風景區', '國家公園區', '河川區', '海域區', '其他使用區或特定專區'],
                    outCity2: ['甲種建築用地', '乙種建築用地', '丙種建築用地', '丁種建築用地', '牧農用地', '林業用地', '養殖用地', '鹽業用地', '礦業用地', '窯業用地', '交通用地', '水利用地', '遊憩用地', '古蹟保存用地', '生態保護用地', '國土保安用地', '殯葬用地', '海域用地', '特定目的事業用地'],
                    national_land_zone: ['不拘', '城一', '城二之一', '城二之二', '城二之三', '城三', '農一', '農二', '農三', '農四', '國一', '國二', '國三', '國四', '海一之一', '海一之二', '海一之三', '海二', '海三', '未分類'],
                    cityList: { "A": "臺北市", "C": "基隆市", "F": "新北市", "H": "桃園市", "O": "新竹市", "J": "新竹縣", "B": "臺中市", "K": "苗栗縣", "N": "彰化縣", "M": "南投縣", "P": "雲林縣", "D": "臺南市", "E": "高雄市", "I": "嘉義市", "Q": "嘉義縣", "T": "屏東縣", "G": "宜蘭縣", "U": "花蓮縣", "V": "臺東縣",/* "X": "澎湖縣", "W": "金門縣", "Z": "連江縣" */},
                    areaList: {},
                    sectionList:{},
                    planList: {},
                    showResault: 0,

                    onepageNum: 20,
                    startPageBtn: 0,
                    nowPage: 0,
                    totalPage: 1,
                    searchRes: [],
                    searchResBox: [],

                    person_onepageNum: 20,
                    person_startPageBtn: 0,
                    person_nowPage: 0,
                    person_totalPage: 1,
                    person_searchRes: [],
                    person_searchResBox: [],

                    searchForm:{
                        land:{
                            "region": {
                                "city": null,
                                "area": null,
                                "plan": null,
                                "section": null,
                                "includeInvalid": 0,
                                "landNumber": "",
                                "national_land_zone": [], // 國土分區
                            },
                            "condition": {
                                "registerReason": {

                                },
                                "ownership": {
                                    "natural": 0,
                                    "private": 0,
                                    "public": 0,
                                    "non_public": 0,
                                    "partially_public": 0
                                },
                                "ownershipType": null,
                                "ownershipNumLowerLimit": 0,
                                "ownershipNumUpperLimit": 0,
                                "areaType": 0,
                                "landAreaLowerLimit": 0,
                                "landAreaUpperLimit": 0,
                                "inCity": [],
                                "outCity": [],
                                "outCity2": {},
                                "presentLowerLimit": 0,
                                "presentUpperLimit": 0,
                            },
                            "other": {
                                "otherRemark": 0,
                                "restrictedRegistration": 0, 
                                "age_range": null,    // 年齡範圍
                                "country": {},      // 國籍
                                "p_part_valueLowerLimit": "", // 個人持分總值
                                "p_part_valueUpperLimit": "",
                                "p_part_areaLowerLimit": "",   // 個人持分總面積
                                "p_part_areaUpperLimit": "",
                                "holding_period": "" // 持有年限
                            }
                        }
                    },
                }
            },
            methods: {
                getArea(city){
                    var T = this;
                    this.searchForm.land.region.area = null;
                    this.searchForm.land.region.plan = null;
                    this.searchForm.land.region.section = null;
                    if(!city || this.areaList[city]) return;
                    new HTTPreq("https://lbor.wsos.com.tw/common/car/get_area/?city=" + city).geta().then((rcv) => {
                        var res = supfnc.toJSON(rcv.result), data = {};
                        for(var i in res){
                            data[city + "_" + res[i].area_code] = res[i].area_name;
                        }
                        T.areaList[city] = data;
                    });
                },
                getSection(area){
                    var T = this;
                    this.searchForm.land.region.section = null;
                    if(!area || this.sectionList[area]) return;
                    new HTTPreq("https://lbor.wsos.com.tw/common/car/get_region/?area=" + area.slice(2,4)+ "&city=" + area[0]).geta().then((rcv) => {
                        var res = supfnc.toJSON(rcv.result), data = {};
                        for(var i in res){
                            data[res[i].car_code] = res[i].region_name;
                        }
                        T.sectionList[area] = data;
                    });
                },
                getPlan(area){
                    var T = this;
                    this.searchForm.land.region.plan = null;
                    if(!area || this.planList[area]) return;
                    new HTTPreq("/v_search/get_plan_name/", "fd").posta({area:area}).then((rcv) => {
                        var res = supfnc.toJSON(rcv.result), data = {};
                        for(var i in res.plan_name){
                            data[res.plan_name[i]] = res.nick_name[i];
                        }
                        T.planList[area] = data;
                    });
                },
                serverSearch(){
                    var T = this;
                    if(!this.searchForm.land.region.city || !this.searchForm.land.region.area || (!this.searchForm.land.region.plan && !this.searchForm.land.region.section)) {
                        Swal.fire("請選擇至段小段或計劃案")
                        return;
                    }
                    new HTTPreq("/v_search/get_search_responseV3/", "fd").setHeaders({'Authorization': 'token a021bd4735ebec44a3564cea9390d91aadfdabff'}).posta({lbtype: "L", searchForm: this.searchForm}).then((rcv) => {
                        var res = supfnc.toJSON(rcv.result);
                        console.log(res)

                        T.searchRes = [];
                        for(var i in res){
                            for(var j in res[i])res[i][j]._lbnum = i.split("_").last();
                            T.searchRes.push(res[i]);
                        }
                        T.totalPage = Math.ceil(T.searchRes.length / T.onepageNum);
                        T.nowPage = 0;
                        Vue.nextTick(()=>{T.nowPage = 1;});

                        var tmp = {};
                        T.person_searchRes = [];
                        for(var i in res){
                            for(var j in res[i]){
                                if(!res[i][j].name || !res[i][j].uid) continue;
                                res[i][j]._key = (res[i][j].name + res[i][j].uid).replace(/[\*]/g, "＊");
                                tmp[res[i][j].name + res[i][j].uid] = res[i][j];
                            }
                        }
                        for(var i in tmp) T.person_searchRes.push(tmp[i]);
                        T.person_totalPage = Math.ceil(T.person_searchRes.length / T.person_onepageNum);
                        T.person_nowPage = 0;
                        Vue.nextTick(()=>{T.person_nowPage = 1;});

                        T.showResault = 1;
                    });
                },
                multipleSelect: function(route, value){
                    var tmp = route.split("."), T = this, d = this;
                    for(var i=0; i<tmp.length-1; i++){
                        if(d[tmp[i]]) d = d[tmp[i]];
                    }
                    d[tmp.last()] = value;
                }
            },
            mounted(){
                ms[0] = this.multipleSelect;
            },
            created(){},
            updated(){},
            beforeUpdate(){},
            watch:{
                nowPage:{
                    handler(nV, oV){
                        var data;
                        this.nowPage = nV.minmax(1, this.totalPage);
                        this.startPageBtn = (this.nowPage-1).minmax(1, Math.max(this.totalPage-2, 1)) - 1;
                        this.searchResBox.length = 0;
                        for(var i=0; i<this.onepageNum; i++){
                            data = this.searchRes[(nV-1) * this.onepageNum + i];
                            if(!data) break;
                            this.searchResBox.push(data);
                        }
                    }
                },
                person_nowPage:{
                    handler(nV, oV){
                        var data;
                        this.person_nowPage = nV.minmax(1, this.person_totalPage);
                        this.person_startPageBtn = (this.person_nowPage-1).minmax(1, Math.max(this.person_totalPage-2, 1)) - 1;
                        this.person_searchResBox.length = 0;
                        for(var i=0; i<this.person_onepageNum; i++){
                            data = this.person_searchRes[(nV-1) * this.person_onepageNum + i];
                            if(!data) break;
                            this.person_searchResBox.push(data);
                        }
                    }
                }
            }
        });

        // test
        // new HTTPreq("/v_search/get_search_responseV3/", "fd").setHeaders({'Authorization': 'token a021bd4735ebec44a3564cea9390d91aadfdabff'}).posta({lbtype: "L", searchForm: vm.searchForm, fake_data: true}).then((rcv) => {
        //     var res = supfnc.toJSON(rcv.result);
        //     console.log(res);
        // });
    </script>
    {% endblock %}
</body>

</html>